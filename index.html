<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Môj Spevník</title>
    <script src="https://cdn.jsdelivr.net/npm/chordsheetjs@5.0.0/dist/chordsheetjs.min.js"></script>
    <style>
        :root { --main-blue: #1a73e8; --chord-color: #d32f2f; --bg: #f8f9fa; }
        body { font-family: 'Segoe UI', sans-serif; margin: 0; background: var(--bg); }
        .header { background: var(--main-blue); color: white; padding: 20px; text-align: center; position: sticky; top: 0; z-index: 100; }
        .container { max-width: 800px; margin: auto; padding: 20px; }
        input#search { width: 100%; padding: 15px; border-radius: 25px; border: none; font-size: 16px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .song-card { background: white; margin: 10px 0; padding: 15px; border-radius: 10px; cursor: pointer; box-shadow: 0 2px 4px rgba(0,0,0,0.05); display: flex; align-items: center; }
        .song-card:hover { background: #f0f7ff; }
        .index { font-weight: bold; margin-right: 15px; color: var(--main-blue); width: 30px; }
        #song-view { display: none; background: white; padding: 25px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        #content { white-space: pre-wrap; line-height: 2; font-family: monospace; font-size: 1.1em; }
        .chord { color: var(--chord-color); font-weight: bold; }
        .btn { padding: 10px 15px; border: none; border-radius: 5px; cursor: pointer; background: var(--main-blue); color: white; margin-right: 5px; }
        .back-btn { background: #6c757d; margin-bottom: 20px; }
    </style>
</head>
<body>

<div class="header">
    <h1>Môj Online Spevník</h1>
    <div class="container" style="padding:0">
        <input type="text" id="search" placeholder="Hľadať pieseň..." oninput="filterSongs()">
    </div>
</div>

<div class="container">
    <div id="list">
        </div>

    <div id="song-view">
        <button class="btn back-btn" onclick="back()">← Späť na zoznam</button>
        <div style="margin-bottom: 20px;">
            <button class="btn" onclick="changeKey(-1)">♭ Znížiť</button>
            <button class="btn" onclick="changeKey(1)"># Zvýšiť</button>
        </div>
        <h2 id="title"></h2>
        <div id="content"></div>
    </div>
</div>

<script>
    // Dáta vytiahnuté priamo z tvojho súboru export.zpk.xml
    const database = [
        { t: "Zvelebený Pán", c: "1. Zvelebený buď tam, kde kraj medom oplýva, tam, kde rieky vždy hojné sú, zvelebený Pán..." },
        { t: "Požehnané meno má Pán", c: "1. Požehnané meno má Pán, (3x) Najvyšší.\nR: Viem, že meno Pána je môj úkryt..." },
        { t: "Nádherný Boh", c: "[D]Úžasný, tak [E]úžasný si [F#m]v láske bez hra[A]níc\nTvoj [D]kríž mi dáva [E]milosť sľúbe[A]nú..." },
        { t: "Bohatier", c: "1. V tebe [D] slaboch [A] je mocný [Am] boha[G]tier, v tebe [D] mocný [A] som ako [Am] boha[G]tier." },
        { t: "Obeta srdca", c: "[D] Túžim priniesť na ol[G]tár život, [A] čo v tebe mám. [D]" },
        { t: "Pred Tebou, môj Pán, sa vzdám", c: "R: [A]Pred tebou, môj [D]Pán, sa [A]vzdám, [F#m]pred tebou na [E]kolená..." },
        { t: "Drž ma bližšie", c: "R: Drž ma bližšie sám deň čo deň, naša láska nech večnosť zrie..." },
        { t: "Tvoj ľud pred Tebou", c: "1. /:Tvoj ľud [D/Em]pred Tebou sa [A/A]schádza, Bože náš..." },
        { t: "Pane náš, prijmi dar", c: "[G]Pane náš, prijmi [C]dar, [G]čo chcem ti dať na ol[C]tár..." },
        { t: "Všetko živé chváli ťa", c: "[C]Všetko [F]živé chváli [G]Ťa, [F] [C]v Duchu, [F]v pravde uctie[G]va." },
        { t: "Dnes viem", c: "1. [D]Dnes viem [G]že chcem [A]za tebou [D]ísť..." },
        { t: "Dávam všetko", c: "1. [C]Dnes chcel by som ti [G]dať to, čo v srdci [F]mám..." },
        { t: "Srdce chvály", c: "1. [D]Hudba dohráva[A], všetko stíši sa[Em]..." },
        { t: "Do tmy na svet", c: "1.[C]Do tmy na[G] svet prišlo [F]k nám svetlo sveta..." },
        { t: "Príď ó Ježiš príď", c: "R: /:[D]Príď,ó Ježiš, [G]príď:/" },
        { t: "Nesieme, Pane, chlieb a víno", c: "N[Dmi]esieme, Pane, chlieb a [C]víno." },
        { t: "Smieme stáť", c: "1. Smieme [C] stáť pred tvojím trónom..." },
        { t: "Imanuel", c: "[Hm]Boh je stále [G]medzi nami, [D]je stále [A]blízko nás." },
        { t: "Toto je telo a toto je krv", c: "R: [C]Toto je telo a [G]toto je [Dm]krv..." },
        { t: "Vitaj pokrm", c: "1. [C#m]Vitaj pokrm, [G#m] v ktorom [A]je neu[H]stále..." },
        { t: "Nechám sa viesť", c: "1. [C#m]Kamkoľvek ma [A]zavoláš, [H]kamkoľvek ma[F#m] zavoláš, pôjdem." },
        { t: "Aj keby nekvitol fík", c: "1. Aj keby nekvitol [Dm] fík, aj keby [B]nerodila zem..." },
        { t: "Chcem z tvojej živej vody piť", c: "1. Chcem z Tvojej živej vody piť, chcem z Tvojho slova stále žiť..." }
    ];

    let currentSong = null;
    let transpose = 0;
    const parser = new ChordSheetJS.ChordProParser();
    const formatter = new ChordSheetJS.HtmlDivFormatter();

    function renderList() {
        const listDiv = document.getElementById('list');
        listDiv.innerHTML = '';
        database.sort((a,b) => a.t.localeCompare(b.t, 'sk')).forEach((song, index) => {
            const div = document.createElement('div');
            div.className = 'song-card';
            div.innerHTML = `<span class="index">${index + 1}.</span> <span>${song.t}</span>`;
            div.onclick = () => showSong(song);
            listDiv.appendChild(div);
        });
    }

    function showSong(song) {
        currentSong = song;
        transpose = 0;
        document.getElementById('list').style.display = 'none';
        document.getElementById('search').parentElement.style.display = 'none';
        document.getElementById('song-view').style.display = 'block';
        document.getElementById('title').innerText = song.t;
        renderContent();
        window.scrollTo(0,0);
    }

    function renderContent() {
        try {
            const parsed = parser.parse(currentSong.c).transpose(transpose);
            document.getElementById('content').innerHTML = formatter.format(parsed);
        } catch(e) {
            document.getElementById('content').innerText = currentSong.c;
        }
    }

    function changeKey(val) { transpose += val; renderContent(); }
    
    function back() {
        document.getElementById('list').style.display = 'block';
        document.getElementById('search').parentElement.style.display = 'block';
        document.getElementById('song-view').style.display = 'none';
        window.scrollTo(0,0);
    }

    function filterSongs() {
        const q = document.getElementById('search').value.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "");
        document.querySelectorAll('.song-card').forEach(card => {
            const title = card.innerText.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "");
            card.style.display = title.includes(q) ? 'flex' : 'none';
        });
    }

    renderList();
</script>

</body>
</html>
